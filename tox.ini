[tox]
minversion = 3.5.3
envlist = py{38,39,310,311,312}, norewrite, pytest6

[testenv]
deps =
    coverage
    mock
    pytest-asyncio
    pytest6: pytest==6.2.5
    pytest-ranking==0.2.6

commands =
    coverage run --append --source={envsitepackagesdir}/pytest_mock -m pytest tests --color=yes

[testenv:norewrite]
commands =
    pytest tests --assert=plain --color=yes

[pytest]
addopts = -r a -vv --durations=0 --rank --rank-weight=0-1-0
asyncio_mode = auto

[flake8]
max-line-length = 88

[testenv:docs]
usedevelop = True
deps =
    -r docs/requirements.txt
commands =
    sphinx-build -W --keep-going -b html docs docs/_build/html {posargs:}
